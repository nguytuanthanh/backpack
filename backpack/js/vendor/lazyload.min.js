!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.LazyLoad=b()}(this,function(){function f(){e||(a={elements_selector:"img",container:window,threshold:300,throttle:50,data_src:"original",data_srcset:"original-set",class_loading:"loading",class_loaded:"loaded",skip_invisible:!0,callback_load:null,callback_error:null,callback_set:null,callback_processed:null},b=!!window.addEventListener,c=!!window.attachEvent,d=!!document.body.classList,e=!0)}function g(a,d,e){if(b)return void a.addEventListener(d,e);c&&(a.attachEvent("on"+d,function(a){return function(){e.call(a,window.event)}}(a)),a=null)}function h(a,d,e){if(b)return void a.removeEventListener(d,e);c&&a.detachEvent("on"+d,e)}function i(a,b,c){function g(){return window.innerWidth||d.documentElement.clientWidth||document.body.clientWidth}function h(){return window.innerHeight||d.documentElement.clientHeight||document.body.clientHeight}function i(a){return a.getBoundingClientRect().top+e-d.documentElement.clientTop}function j(a){return a.getBoundingClientRect().left+f-d.documentElement.clientLeft}function k(){return(b===window?h()+e:i(b)+b.offsetHeight)<=i(a)-c}function l(){return(b===window?g()+window.pageXOffset:j(b)+g())<=j(a)-c}function m(){return(b===window?e:i(b))>=i(a)+c+a.offsetHeight}function n(){return(b===window?f:j(b))>=j(a)+c+a.offsetWidth}var d,e,f;return d=a.ownerDocument,e=window.pageYOffset||d.body.scrollTop,f=window.pageXOffset||d.body.scrollLeft,!(k()||m()||l()||n())}function j(){return(new Date).getTime()}function k(a,b){var d,c={};for(d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);return c}function l(a){try{return Array.prototype.slice.call(a)}catch(e){var c,b=[],d=a.length;for(c=0;c<d;c++)b.push(a[c]);return b}}function m(a,b){if(d)return void a.classList.add(b);a.className+=(a.className?" ":"")+b}function n(a,b){if(d)return void a.classList.remove(b);a.className=a.className.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")}function o(a,b){var c=a.parentElement;if("PICTURE"===c.tagName)for(var d=0;d<c.children.length;d++){var e=c.children[d];if("SOURCE"===e.tagName){var f=e.getAttribute("data-"+b);f&&e.setAttribute("srcset",f)}}}function p(a,b,c){var d=a.tagName,e=a.getAttribute("data-"+c);if("IMG"===d){o(a,b);var f=a.getAttribute("data-"+b);return f&&a.setAttribute("srcset",f),void(e&&a.setAttribute("src",e))}if("IFRAME"===d)return void(e&&a.setAttribute("src",e));a.style.backgroundImage="url("+e+")"}function q(a,b){return function(){return a.apply(b,arguments)}}function r(b){f(),this._settings=k(a,b),this._queryOriginNode=this._settings.container===window?document:this._settings.container,this._previousLoopTime=0,this._loopTimeout=null,this._handleScrollFn=q(this.handleScroll,this),g(window,"resize",this._handleScrollFn),this.update()}var a,b,c,d,e=!1;return r.prototype._showOnAppear=function(a){function c(){null!==b&&(b.callback_load&&b.callback_load(a),n(a,b.class_loading),m(a,b.class_loaded),h(a,"load",c))}var b=this._settings;"IMG"!==a.tagName&&"IFRAME"!==a.tagName||(g(a,"load",c),g(a,"error",function(){h(a,"load",c),n(a,b.class_loading),b.callback_error&&b.callback_error(a)}),m(a,b.class_loading)),p(a,b.data_srcset,b.data_src),b.callback_set&&b.callback_set(a)},r.prototype._loopThroughElements=function(){var a,b,c=this._settings,d=this._elements,e=d?d.length:0,f=[];for(a=0;a<e;a++)b=d[a],c.skip_invisible&&null===b.offsetParent||i(b,c.container,c.threshold)&&(this._showOnAppear(b),f.push(a),b.wasProcessed=!0);for(;f.length>0;)d.splice(f.pop(),1),c.callback_processed&&c.callback_processed(d.length);0===e&&this._stopScrollHandler()},r.prototype._purgeElements=function(){var a,b,c=this._elements,d=c.length,e=[];for(a=0;a<d;a++)b=c[a],b.wasProcessed&&e.push(a);for(;e.length>0;)c.splice(e.pop(),1)},r.prototype._startScrollHandler=function(){this._isHandlingScroll||(this._isHandlingScroll=!0,g(this._settings.container,"scroll",this._handleScrollFn))},r.prototype._stopScrollHandler=function(){this._isHandlingScroll&&(this._isHandlingScroll=!1,h(this._settings.container,"scroll",this._handleScrollFn))},r.prototype.handleScroll=function(){var a,b,c;this._settings&&(b=j(),c=this._settings.throttle,0!==c?(a=c-(b-this._previousLoopTime),a<=0||a>c?(this._loopTimeout&&(clearTimeout(this._loopTimeout),this._loopTimeout=null),this._previousLoopTime=b,this._loopThroughElements()):this._loopTimeout||(this._loopTimeout=setTimeout(q(function(){this._previousLoopTime=j(),this._loopTimeout=null,this._loopThroughElements()},this),a))):this._loopThroughElements())},r.prototype.update=function(){this._elements=l(this._queryOriginNode.querySelectorAll(this._settings.elements_selector)),this._purgeElements(),this._loopThroughElements(),this._startScrollHandler()},r.prototype.destroy=function(){h(window,"resize",this._handleScrollFn),this._loopTimeout&&(clearTimeout(this._loopTimeout),this._loopTimeout=null),this._stopScrollHandler(),this._elements=null,this._queryOriginNode=null,this._settings=null},r});